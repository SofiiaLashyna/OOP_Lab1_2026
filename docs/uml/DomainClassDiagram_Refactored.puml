@startuml
skinparam classAttributeIconSize 0

legend top left
  | Color | Architectural Changes Description |
  |<color:red>~~Red Strikethrough~~</color>| **Removed** (Violations of SRP or UI coupling) |
  |<color:green>**Green Bold**</color>| **Added** (New abstractions and Factory Pattern) |
  |<#E8F5E9>| **New Classes / Structs** |
endlegend

package DOMAIN {

    note "SRP CHANGE:\nGeneration logic is extracted\nfrom Galaxy to GalaxyFactory." as N_Factory
    class "GalaxyFactory" as GalaxyFactory #E8F5E9 {
      + <color:green>**generatePlanet(...) : Planet***</color>
      + <color:green>**generateStarSystem(...) : StarSystem***</color>
      + <color:green>**generateNebula(...) : Nebula***</color>
      + <color:green>**generateGalaxy(...) : void**</color>
    }

    note "DECOUPLING CHANGE:\nReplaced Qt-specific QColor\nwith abstract RGBColor\nto decouple Domain from UI." as N_Color
    struct "RGBColor" as RGBColor #E8F5E9 {
      + r : int
      + g : int
      + b : int
      + a : int
    }
    RGBColor .up. N_Color

    abstract class CelestialObject {
      - name : std::string
      - mass : double
      + CelestialObject(name: string, mass: double)
      + ~CelestialObject()
      + {abstract} displayInfo() : void
      + {abstract} getType() : string
      + getName() : string
      + setName(newName: string) : void
      + getMass() : double
      + setMass(newMass: double) : void
    }

    enum starType {
      Red_Giant
      White_Dwarf
      Neutron_Star
      Red_Dwarf
      Brown_Dwarf
      Main_sequence_Star
    }

    class Star {
      - temperature : double
      - star_type : starType
      + Star(name, mass, temp, type)
      + ~Star()
      + displayInfo() : void
      + getType() : string
      + setStarType(type: string) : void
      + getStarType() : starType
      + getStarTypeString() : string
      + getTemperature() : double
    }

    enum planetType {
      Gas_Giant
      Dwarf
      Terrestrial_Planet
    }

    class Planet {
      - orbitRadius : double
      - orbitSpeed : double
      - inclination : double
      - habitable : bool
      <color:red>~~- color : QColor~~</color>
      <color:green>**- color : RGBColor**</color>
      - texturePath : std::string
      - rings : bool
      - ringInnerRadiusFactor : double
      - ringOuterRadiusFactor : double
      <color:red>~~- ringColor : QColor~~</color>
      <color:green>**- ringColor : RGBColor**</color>
      - planet_type : planetType
      + Planet(...)
      + displayInfo() : void
      + getOrbit() : double
      + setOrbit(newOrbit: double) : void
      + isHabitable() : bool
      + getType() : string
      + getPlanetType() : planetType
      + hasRings() : bool
    }

    enum nebulaType {
      Planetary
      Supernova
      Emission
      Reflection
      Dark
    }

    class Nebula {
      - nebula_type : nebulaType
      + Nebula(name, mass, type)
      + ~Nebula()
      + displayInfo() : void
      + getType() : string
      + getNebulaType() : nebulaType
      + getNebulaTypeString() : string
      + setNebulaType(newtype: string) : void
    }

    class StarSystem {
      - id : int
      - centralStar : Star*
      - planets : std::vector<Planet*>
      - sortPlanetsByOrbit() : void
      + StarSystem(id, name, star)
      + ~StarSystem()
      + addPlanet(planet: Planet*) : void
      + removePlanet() : void
      + removePlanet(name: string) : void
      + getStar() : Star&
      + getPlanets() : vector<Planet*>&
      + displayInfo() : void
      + getType() : string
      + calculateMass() : double
      + getId() : int
      + lifeExists(planet: Planet&) : void
    }

    class "Galaxy <GraphType>" as Galaxy {
      - name : std::string
      - systemGraph : GraphType
      - celestial_objects : std::vector<CelestialObject*>
      + Galaxy(name: string)
      + ~Galaxy()
      + objectCount() : int
      + addObject(obj: CelestialObject*) : void
      + getObject() : vector<CelestialObject*>&
      + connectObjects(id1, id2, distance) : void
      + getGraph() : GraphType&
      + showGalaxy() : void
      + getGalaxyParameters() : QString
      <color:red>~~+ generatePlanet(...) : Planet*~~</color>
      <color:red>~~+ generateStarSystem(...) : StarSystem*~~</color>
      <color:red>~~+ generateNebula(...) : Nebula*~~</color>
      <color:red>~~+ generateGalaxy(...) : void~~</color>
    }

    CelestialObject <|-- Star
    CelestialObject <|-- Planet
    CelestialObject <|-- Nebula
    CelestialObject <|-- StarSystem

    StarSystem *-- Star : contains 1
    StarSystem *-- Planet : contains 0..*
    Galaxy *-- CelestialObject : manages 0..*

    Star --> starType
    Planet --> planetType
    Nebula --> nebulaType
    
    Galaxy .[#red].> StarSystem : <color:red>~~creates~~</color>
    Galaxy .[#red].> Nebula : <color:red>~~creates~~</color>
    Galaxy .[#red].> Planet : <color:red>~~creates~~</color>
    
    GalaxyFactory ..> Galaxy : <color:green>**populates**</color>
    GalaxyFactory ..> StarSystem : <color:green>**creates**</color>
    GalaxyFactory ..> Nebula : <color:green>**creates**</color>
    GalaxyFactory ..> Planet : <color:green>**creates**</color>
    GalaxyFactory .up. N_Factory

    Planet --> RGBColor : <color:green>**uses**</color>
}
@enduml